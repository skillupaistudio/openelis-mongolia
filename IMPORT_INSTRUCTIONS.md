# Generic Sample Order Import - Instructions

## File Format

The import functionality supports both **CSV** and **Excel** (.xlsx, .xls)
files.

## Required Columns

The first row must contain column headers. The following columns are supported:

### Column Name Variations (case-insensitive)

| Field                      | Accepted Column Names                                         | Required    | Notes                                                      |
| -------------------------- | ------------------------------------------------------------- | ----------- | ---------------------------------------------------------- |
| Lab Number                 | `labNo`, `labNumber`, `accessionNumber`, `accession`          | No          | **Auto-generated by system** (leave blank or omit column)  |
| Sample Type                | `sampleTypeId`, `sampleType`, `type`                          | Recommended | Can be ID or description                                   |
| Quantity                   | `quantity`, `sampleQuantity`                                  | No          | Quantity for sample item                                   |
| Unit of Measure            | `sampleUnitOfMeasure`, `uom`, `unit`                          | No          | Can be ID or name/description                              |
| From                       | `from`, `referringId`, `referring`                            | No          | Referring physician/location                               |
| Collector                  | `collector`, `collectedBy`                                    | No          | Person who collected the sample                            |
| Collection Date            | `collectionDate`, `date`, `coldate`                           | No          | Format: MM/dd/yyyy                                         |
| Collection Time            | `collectionTime`, `time`, `coltime`                           | No          | Format: HH:mm or HH:mm:ss                                  |
| Lab Person Received        | `labPersonReceived`, `receivedBy`, `received`                 | No          | Lab person who received the sample                         |
| Sample Quantity            | `sampleQuantity`, `numberOfSamples`, `qty`                    | No          | **Number of samples to create from this row** (default: 1) |
| Serial Number (Logbook)    | `sn`, `serialNumber`                                          | No          | Stored in the questionnaire metadata                       |
| Project / Study            | `project`, `projectName`                                      | No          | Stored in the questionnaire metadata                       |
| Sample ID Range            | `id`, `sampleId`, `sampleIdentifier`                          | No          | Stored in the questionnaire metadata                       |
| Sample Count (#)           | `number`, `sampleCount`                                       | No          | Stored in the questionnaire metadata                       |
| Storage Freezer & Location | `storageFreezerLocation`, `storageFreezer`, `storageLocation` | No          | Stored in the questionnaire metadata                       |

## Important Notes

1. **Sample Quantity Column**: If you want to create multiple samples from a
   single row, use the `sampleQuantity` column. For example, if `sampleQuantity`
   is 3, the system will create 3 separate samples with the same data (each will
   get a unique accession number).

2. **Lab Number**: **Always auto-generated by the system**. Leave the labNo
   column blank or omit it entirely. Each sample will receive a unique accession
   number automatically.

3. **Sample Type**: You can use either:

   - The sample type ID (e.g., "1")
   - The sample type description (e.g., "Blood", "Urine")

4. **Questionnaire-only Columns**: `sn`, `project`, `id`, `number`, and
   `storageFreezerLocation` are saved in the default logbook questionnaire so
   you can capture the additional datapoints shown in the field log sheet.

5. **Date Format**: Use MM/dd/yyyy format (e.g., 12/15/2024)

6. **Time Format**: Use HH:mm or HH:mm:ss format (e.g., 14:30 or 14:30:00)

## Example CSV File

```csv
sn,project,id,number,storageFreezerLocation,sampleTypeId,quantity,sampleUnitOfMeasure,from,collector,collectionDate,collectionTime,labPersonReceived,sampleQuantity
1,DPP,001to034,91,PARA Freezer,Blood,2.5,ml,Dr. Smith,John Doe,12/15/2024,14:30,admin,1
2,DPP,001-034,34,PARA Freezer,Urine,1.0,ml,Dr. Jones,Jane Smith,12/15/2024,15:00,admin,2
3,DPP,001-034,34,PARA Freezer,Stool,3.0,ml,Dr. Brown,Bob Wilson,12/16/2024,09:15,admin,1
4,DPP,001-034,35,PARA Freezer,Blood,1.5,ml,Dr. Davis,Alice Johnson,12/16/2024,10:00,admin,3
5,Urban,Animal IDs,30,PARA Freezer,Urine,2.0,ml,Dr. Miller,Charlie Brown,12/16/2024,11:30,admin,1
```

**Note**: Lab numbers are automatically generated by the system for each sample,
so the `labNo` column is omitted.

## Validation Process

1. **Upload File**: Select your CSV or Excel file
2. **Validate**: Click "Validate" to check for errors
   - The system will check:
     - File format
     - Header columns
     - Data types and formats
     - Required relationships (e.g., valid sample types)
3. **Review Results**:
   - Check validation errors (if any)
   - Review preview of valid rows
   - See total number of samples that will be created
4. **Import**: If validation passes, click "Import" to create the samples

## Tips

- Start with a small test file to verify your format
- Use the validation feature before importing large batches
- Check the preview table to ensure data is parsed correctly
- If sample type or unit of measure validation fails, check that you're using
  the correct IDs or names as they exist in the system
